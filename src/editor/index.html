<div class="main-content-primary">

  <div class="actions" ng-if="!enterPressed">
    <h2>Bienvenue sur YML Editor</h2>
    <div class="action_container">
      <span class="tip">1</span>
      <div class="action_list">
        <p>Importer votre premier fichier</p>
        <label class="btn btn-default btn-file lhs">
          <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 72 72">
            <g fill="none" fill-rule="evenodd" stroke="white" stroke-width="3" transform="translate(18 18)" stroke-linecap="round" stroke-linejoin="round">
              <path d="M23.1428571 5.5958279L18 .665710561M33.4285714 8.06088657C34.8505714 8.06088657 36 9.1627678 36 10.5259452L36 32.7114733C36 34.0746507 34.8505714 35.1765319 33.4285714 35.1765319L2.57142857 35.1765319C1.14942857 35.1765319 0 34.0746507 0 32.7114733L0 10.5259452C0 9.1627678 1.14942857 8.06088657 2.57142857 8.06088657M18 25.3162973L18 .665710561M18 .665710561L12.8571429 5.5958279"/>
            </g>
          </svg>
          <input type="file" class="lhs" style="display: none;" fileread="lhs">
        </label>
      </div>

      <div class="action_list">
        <p>Importer votre second fichier</p>
        <label class="btn btn-default btn-file rhs">
          <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 72 72">
            <g fill="none" fill-rule="evenodd" stroke="white" stroke-width="3" transform="translate(18 18)" stroke-linecap="round" stroke-linejoin="round">
              <path d="M23.1428571 5.5958279L18 .665710561M33.4285714 8.06088657C34.8505714 8.06088657 36 9.1627678 36 10.5259452L36 32.7114733C36 34.0746507 34.8505714 35.1765319 33.4285714 35.1765319L2.57142857 35.1765319C1.14942857 35.1765319 0 34.0746507 0 32.7114733L0 10.5259452C0 9.1627678 1.14942857 8.06088657 2.57142857 8.06088657M18 25.3162973L18 .665710561M18 .665710561L12.8571429 5.5958279"/>
            </g>
          </svg>
          <input type="file" class="rhs" style="display: none;" fileread="rhs">
        </label>
      </div>
    </div>

    <div class="action_container">
      <span class="tip">2</span>
      <button class="custom-button" ng-click="enterPressed = (metadata) ? true : undefined; return"> Démarrer </button>
      <span class="tooltip ">Press <strong>Enter</strong></span>
    </div>
  </div>

  <div class="statistics " ng-if="metadata && enterPressed ">
    <div class="statistics_container">
      <div class="statistics_data ">
        <h3>{{ratioMissing}} %</h3>
        <p><strong>{{ inputs - missingInputs }}</strong> / {{ inputs }} </p>
      </div>
      <div class="statistics_action ">
        <a class="btn btn-primary " ng-click="export(metadata, 'lhs') " role="button ">Exporter</a>
      </div>
    </div>

  </div>

  <div class="metadata " ng-if="metadata && enterPressed ">
    <table class="table ">
      <thead>
        <tr>
          <th>Ref</th>
          <th>{{initialLang}} - <a class="btn btn-primary lhs" ng-click="export(metadata, 'lhs') " role="button ">Export</a></th>
          <th>{{totranslateLang}} - <a class="btn btn-primary rhs" ng-click="export(metadata, 'rhs') " role="button ">Export</a></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat="(key, value) in metadata " ng-class="value.hasOwnProperty('missing') ? 'missing' : '' ">
          <td>
            <div class="index">{{$index}}</div>
          </td>
          <td>
            <input class="form-control " type="text " ng-focus="setSpecific('lhs');setSelected($index)" ng-model="value.lhs " ng-change="markMissingTranslations(value);calculateStatistics() ">
          </td>
          <td>
            <input class="form-control " type="text " ng-focus="setSpecific('rhs');setSelected($index)" ng-model="value.rhs " ng-change="markMissingTranslations(value);calculateStatistics() ">
          </td>
          <td class="specific_button">
            <button ng-click="goToMissingStep(keyIndex, keySpecific)" class="btn btn-primary">Suivant</button>
            <span class="tooltip">Press <strong>Enter</strong></span>
          </td>
          <!--<td>

              </td>-->
        </tr>
      </tbody>
    </table>
  </div>

</div>

<script type="text/ng-template " id="exportModal.html ">
  <div class="modal-header ">
    <h3 class="modal-title " id="modal-title ">Choissisez le nom du fichier à exporter</h3>
  </div>
  <div class="modal-body " id="modal-body ">
    <input class="form-control " type="text " ng-model="filename ">
  </div>
  <div class="modal-footer ">
    <button class="btn btn-primary " type="button " ng-click="$close(filename); ">Export</button>
    <button class="btn btn-warning " type="button " ng-click="$dismiss( 'cancel'); ">Cancel</button>
  </div>
</script>

<script>
  document.addEventListener('keydown', function (event) {
    if (event.which === 13) {
      var scope = angular.element($(".main-content-primary ")).scope();
      if (scope.metadata) {
        scope.$apply(function () {
          scope.enterPressed = true;
        })
        this.removeEventListener('click', arguments.callee, true)
      }
    }
  })

</script>